% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calcHI.R
\name{calcHI}
\alias{calcHI}
\title{Compute Heat Index (fast parallel C++ core)}
\usage{
calcHI(
  airTemp,
  relativeHumidity,
  inputunits = NULL,
  outputunits = "degF",
  roundby = 1,
  returnWithUnits = TRUE,
  ignoreattr = FALSE,
  debug = FALSE
)
}
\arguments{
\item{airTemp}{Numeric vector of air temperature. May carry \code{attr(., "unit")}.}

\item{relativeHumidity}{Numeric vector of RH in percent (0â€“100).}

\item{inputunits}{Character or \code{NULL}; one of \code{"degC"}, \code{"degF"}, \code{"K"}.
Only needed if \code{ignoreattr = TRUE} and no attribute is present.}

\item{outputunits}{Character; \code{"degF"} (default) or \code{"degC"} for the returned HI.}

\item{roundby}{Integer; decimal places to round the output (default \code{1}).}

\item{returnWithUnits}{Logical; if \code{TRUE}, sets \code{attr(result, "unit")} to \code{outputunits}.}

\item{ignoreattr}{Logical; see Unit handling.}

\item{debug}{Logical; if \code{TRUE}, emit a brief trace of unit decisions.}
}
\value{
Numeric vector of Heat Index in \code{outputunits}. If
\code{returnWithUnits = TRUE}, the result has \code{attr(x, "unit") = outputunits}.
}
\description{
Calculates Heat Index (HI) from air temperature and relative humidity. Handles
input unit declaration via argument and/or \code{attr(x, "unit")}. The C++ core
computes HI in Fahrenheit; output can be returned in \code{"degF"} or \code{"degC"}.
}
\section{Unit handling}{

\itemize{
\item If \code{ignoreattr = FALSE} (default), the function requires
\code{attr(airTemp, "unit")} and enforces agreement with \code{inputunits}
when provided; otherwise it errors on mismatch/missing attribute.
\item If \code{ignoreattr = TRUE}, the function accepts either the attribute or
\code{inputunits} (but needs at least one).
\item Internally, temperature is normalized to \code{"degF"} before calling the C++ core.
}
}

\examples{
# Attribute-driven (degC -> converted internally to degF for core)
ta <- c(30, 35, 40); attr(ta, "unit") <- "degC"
rh <- c(50, 60, 65)
hiF <- calcHI(ta, rh, outputunits = "degF")
attr(hiF, "unit")  # "degF"

# Explicit input units, Celsius output
hiC <- calcHI(ta, rh, inputunits = "degC", outputunits = "degC")

# Ignore attribute and trust supplied units
attr(ta, "unit") <- "degF"  # wrong on purpose
hi_ok <- calcHI(ta, rh, inputunits = "degC", outputunits = "degF", ignoreattr = TRUE)

# data.table pattern
if (requireNamespace("data.table", quietly = TRUE)) {
  DT <- data.table::data.table(ta = c(30, 35), rh = c(50, 60))
  attr(DT$ta, "unit") <- "degC"
  DT[, hi := calcHI(ta, rh, outputunits = "degC")]
  attr(DT$hi, "unit")  # "degC"
}

}
\seealso{
\code{\link{unit}} for lightweight unit tagging.
}
